!function(){function t(e,i,o){function r(s,a){if(!i[s]){if(!e[s]){var h="function"==typeof require&&require;if(!a&&h)return h(s,!0);if(n)return n(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[s]={exports:{}};e[s][0].call(u.exports,function(t){var i=e[s][1][t];return r(i||t)},u,u.exports,t,e,i,o)}return i[s].exports}for(var n="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}return t}()({1:[function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=t("states/boot"),h=o(a),l=t("states/preload"),u=o(l),c=t("states/menu"),d=o(c),f=t("states/play"),p=o(f),y=t("states/gameover"),g=o(y),m=function(t){function e(){r(this,e);var t=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,360,640,Phaser.AUTO,"content",null));return t.state.add("Boot",h["default"]),t.state.add("Preload",u["default"]),t.state.add("Menu",d["default"]),t.state.add("Play",p["default"]),t.state.add("GameOver",g["default"]),t.state.start("Boot"),t}return s(e,t),e}(Phaser.Game);new m},{"states/boot":2,"states/gameover":3,"states/menu":4,"states/play":5,"states/preload":6}],2:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),a=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"preload",value:function(){this.stage.backgroundColor="#f6e787",this.load.image("background","./images/backgrounds/background.jpg")}},{key:"create",value:function(){this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.add.sprite(0,0,"background"),this.state.start("Preload")}}]),e}(Phaser.State);i["default"]=a},{}],3:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),a=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"init",value:function(t){this.score=t}},{key:"create",value:function(){var t=this;this.background=this.add.sprite(0,0,"background"),this.scoreText=this.add.text(0,-15,this.score,{font:"70px Fredoka One",fill:"white"}),this.scoreText.anchor.set(.5),this.bgScore=this.add.sprite(this.world.centerX,.4*this.world.height,"bg-score"),this.bgScore.addChild(this.scoreText),this.bgScore.anchor.set(.5),this.bgScore.scale.set(.6),this.timeup=this.add.sprite(.5*this.world.width,.55*this.world.height,"timeup"),this.timeup.anchor.set(.5),this.timeup.scale.set(.5),this.input.onDown.add(function(){t.state.start("Menu")})}}]),e}(Phaser.State);i["default"]=a},{}],4:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),a=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"create",value:function(){this.add.sprite(0,0,"background"),this.music=this.add.audio("bg-music"),this.music.loopFull(),this.soundBtn=this.add.button(this.world.width-85,15,"btn-sfx",this.handleSound,this),this.soundBtn.scale.set(.5),this.sound.mute&&(this.soundBtn.tint=8421504),this.soundBtn.visible=!1,this.logo=this.add.sprite(.5*this.world.width,.4*this.world.height,"logo"),this.logo.anchor.set(.5),this.logo.scale.setTo(.5),this["in"]("top",this.logo),this.playBtn=this.add.button(.5*this.world.width,.6*this.world.height,"btn-play",this.startGame,this),this.playBtn.anchor.set(.5),this.playBtn.scale.setTo(.5),this.playBtnSound=this.add.audio("select-1"),this.playBtn.setDownSound(this.playBtnSound)}},{key:"in",value:function(t,e){var i=this,o=this.add.tween(e),r=e.x,n="top"==t?0-e.height:this.world.height+e.height;o.from({x:r,y:n},750,Phaser.Easing.Linear.None,!0).onComplete.add(function(){return i.soundBtn.visible=!0})}},{key:"startGame",value:function(){this.music.stop(),this.out("top",this.logo),this.out("bottom",this.playBtn)}},{key:"out",value:function(t,e){var i=this;this.soundBtn.visible=!1;var o=this.add.tween(e),r=e.x,n="top"==t?0-e.height:this.world.height+e.height;o.to({x:r,y:n},375,Phaser.Easing.Linear.None,!0),o.onComplete.add(function(){return i.state.start("Play")})}},{key:"handleSound",value:function(){this.sound.mute?this.soundBtn.tint=16777215:this.soundBtn.tint=8421504,this.sound.mute=!this.sound.mute}}]),e}(Phaser.State);i["default"]=a},{}],5:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,e){var i=[],o=!0,r=!1,n=void 0;try{for(var s,a=t[Symbol.iterator]();!(o=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);o=!0);}catch(h){r=!0,n=h}finally{try{!o&&a["return"]&&a["return"]()}finally{if(r)throw n}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),l=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),h(e,[{key:"create",value:function(){var t=this;this.background=this.add.sprite(0,0,"background"),this.music=this.add.audio("bg-music"),this.music.loopFull(),this.bgBottom=this.add.graphics(0,0),this.bgBottom.beginFill(16181127),this.bgBottom.drawRect(0,this.world.height-100,this.world.width,100),this.bgBottom.endFill(),this.score=0,this.scoreText=this.add.text(0,-15,"",{font:"70px Fredoka One",fill:"white"}),this.scoreText.anchor.set(.5),this.bgScore=this.add.sprite(this.world.centerX+10,this.world.height-40,"bg-score"),this.bgScore.addChild(this.scoreText),this.bgScore.anchor.set(.5),this.bgScore.scale.set(.5),this.bgScore.inputEnabled=!0,this.scoreSound=this.add.audio("score-sound"),this.timeLeft=60,this.bgTimer=this.add.graphics(0,0),this.bgTimer.beginFill(7829367),this.bgTimer.lineStyle(5,12318454),this.bgTimer.drawCircle(50,this.world.height-48,80),this.bgTimer.endFill(),this.timerText=this.add.text(51,this.world.height-45,this.timeLeft,{font:"45px Fredoka One",fill:"white"}),this.timerText.anchor.set(.5),this.timer=this.game.time.create(!1),this.timer.loop(Phaser.Timer.SECOND,this.updateTimer,this),this.timer.start(),this.menu=this.add.graphics(0,0),this.menu.beginFill(14160916),this.menu.drawRoundedRect(this.world.width-80,this.world.height-66,70,45,10),this.menu.endFill(),this.menu.inputEnabled=!0,this.menu.events.onInputDown.add(function(){return t.gameOver()}),this.menuText=this.add.text(this.world.width-65,this.world.height-55,"END",{font:"20px Fredoka One",fill:"white"}),this.tiles=[],this.collums=6,this.rows=9,this.fillBoard(),this.onSelectModificator=1.2,this.selected,this.selected2,this.drag=!1}},{key:"update",value:function(){this.drag&&this.selected&&this.input.activePointer.isUp&&(this.selected!=this.selected2&&this.trySwap(),this.drag=!1)}},{key:"updateTimer",value:function(){this.timeLeft--,0==this.timeLeft&&this.gameOver(),this.timerText.setText(this.timeLeft)}},{key:"fillBoard",value:function(){for(var t=0;t<this.collums;t++){for(var e=[],i=0;i<2*this.rows;i++)e.push(this.createTile(t,i,1e3,e,!0));this.tiles.push(e)}}},{key:"createTile",value:function(t,e,i,o,r){var n=this,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Phaser.Easing.Linear.None,a=this.world.width/this.collums,h=["gem-01","gem-02","gem-03","gem-04","gem-05","gem-06"];if(r){if(t>1){var l=this.tiles[t-1][e].key,u=this.tiles[t-2][e].key;l==u&&(h=h.filter(function(t){return t!=l}))}if(e>1){var c=o[e-1].key,d=o[e-2].key;c==d&&(h=h.filter(function(t){return t!=c}))}}var f=this.rnd.pick(h),p=a*t+a/2,y=this.world.height-this.bgBottom.height-a-a*e+a/2,g=this.add.sprite(p,y,f);return g.addChild(this.make.sprite(6,6,"gem-shadow")),g.addChild(this.make.sprite(0,0,f)),g.anchor.setTo(.5),g.children.forEach(function(t){return t.anchor.setTo(.5)}),g.width=a,g.height=a,g.col=t,g.row=e,g.inputEnabled=!0,g.events.onInputDown.add(function(t){n.select(t),n.drag=!0}),g.events.onInputOver.add(function(t){return n.selected2=t}),g.events.onDestroy.add(function(t){return n.handleDestroy(t)}),this.add.tween(g).from({x:p,y:0-a-a*e},i,s,!0),g}},{key:"select",value:function(t){var e=this.onSelectModificator;this.selected?(this.drag=!1,this.trySwap()):(this.selected=t,this.selected.height=this.selected.height*e,this.selected.width=this.selected.width*e)}},{key:"deselect",value:function(){var t=this.onSelectModificator;this.selected.height=this.selected.height/t,this.selected.width=this.selected.width/t,this.selected=!1}},{key:"trySwap",value:function(){var t=this.selected,e=this.selected2;if(this.drag){var i=e.col,o=e.row;Math.abs(t.row-e.row)>Math.abs(t.col-e.col)?(o=t.row>e.row?t.row-1:t.row+1,i=t.col):(i=t.col>e.col?t.col-1:t.col+1,o=t.row),e=this.tiles[i][o],this.drag=!1}e.col==t.col-1||e.col==t.col+1?e.row==t.row&&this.compare(t,e):e.row!=t.row-1&&e.row!=t.row+1||e.col==t.col&&this.compare(t,e),this.deselect()}},{key:"compare",value:function(t,e){var i=this;if(!(t.row>=this.rows)){var o=this.deepCopy(this.tiles),r=o[t.col][t.row],n=e?o[e.col][e.row]:"",s=this.tiles[r.col][r.row],a=e?this.tiles[n.col][n.row]:"",h=void 0,l=void 0,u=[],c=[];if(e){var d=[n.key,r.key];r.key=d[0],n.key=d[1]}h=r.col,l=r.row;for(var f=1;l+f<this.rows&&r.key==o[h][l+f].key;f++)c.push(this.tiles[h][l+f]);for(var p=1;l-p>=0&&r.key==o[h][l-p].key;p++)c.push(this.tiles[h][l-p]);c.length>1&&(u=u.concat(c)),c=[];for(var y=1;h+y<this.collums&&r.key==o[h+y][l].key;y++)c.push(this.tiles[h+y][l]);for(var g=1;h-g>=0&&r.key==o[h-g][l].key;g++)c.push(this.tiles[h-g][l]);if(c.length>1&&(u=u.concat(c)),u.length>0&&(e?u.push(a):u.push(s)),!e){if(0==u.length)return;return void this.destroyMatched(u)}c=[],h=n.col,l=n.row;for(var m=1;l+m<this.rows&&n.key==o[h][l+m].key;m++)c.push(this.tiles[h][l+m]);for(var b=1;l-b>=0&&n.key==o[h][l-b].key;b++)c.push(this.tiles[h][l-b]);c.length>1&&(u=u.concat(c)),c=[];for(var w=1;h+w<this.collums&&n.key==o[h+w][l].key;w++)c.push(this.tiles[h+w][l]);for(var v=1;h-v>=0&&n.key==o[h-v][l].key;v++)c.push(this.tiles[h-v][l]);c.length>1&&(u=u.concat(c)),u.length>0&&u.push(s);var k=[this.tiles[n.col][n.row],this.tiles[r.col][r.row]];this.tiles[r.col][r.row]=k[0],this.tiles[n.col][n.row]=k[1];var O=[a.col,s.col];s.col=O[0],a.col=O[1];var _=[a.row,s.row];s.row=_[0],a.row=_[1],this.add.tween(s).to({x:a.x,y:a.y},300,Phaser.Easing.Linear.None,!0),this.add.tween(a).to({x:s.x,y:s.y},300,Phaser.Easing.Linear.None,!0).onComplete.add(function(){return i.destroyMatched(u)})}}},{key:"deepCopy",value:function(t){var e=this,i=[];return t.forEach(function(t){Array.isArray(t)?i.push(e.deepCopy(t)):"object"===("undefined"==typeof t?"undefined":a(t))&&null!=t?i.push(e.copyObject(t)):i.push(t)}),i}},{key:"copyObject",value:function(t){var e={},i=!0,o=!1,r=void 0;try{for(var n,a=Object.entries(t)[Symbol.iterator]();!(i=(n=a.next()).done);i=!0){var h=s(n.value,2),l=h[0],u=h[1];e[l]=u}}catch(c){o=!0,r=c}finally{try{!i&&a["return"]&&a["return"]()}finally{if(o)throw r}}return e}},{key:"destroyMatched",value:function(t){var e=this;this.addToScore(t.length);var i=!0,o=!1,r=void 0;try{for(var n,s=function(){var t=n.value;e.add.tween(t.scale).to({x:0,y:0},275,Phaser.Easing.Linear.None,!0).onComplete.add(function(){return t.destroy()})},a=t[Symbol.iterator]();!(i=(n=a.next()).done);i=!0)s()}catch(h){o=!0,r=h}finally{try{!i&&a["return"]&&a["return"]()}finally{if(o)throw r}}}},{key:"addToScore",value:function(t){if(0!=t){this.scoreSound.play();var e=t-3;this.score+=100*t+100*e,this.scoreText.setText(this.score)}}},{key:"handleDestroy",value:function(t){var e=this,i=600,o={col:t.col,row:t.row};this.tiles[o.col].splice(o.row,1);var r=this.createTile(o.col,this.tiles[o.col].length-1,i);this.tiles[o.col].push(r);for(var n=0;n<this.tiles[o.col].length;n++){var s=this.tiles[o.col][n];s.row=n;var a=this.world.height-this.bgBottom.height-s.height-s.height*n+s.height/2;this.add.tween(s).to({y:a},i,void 0,!0).onComplete.addOnce(function(t){return e.compare(t)})}}},{key:"gameOver",value:function(){this.music.stop(),this.world.removeAll(),this.state.start("GameOver",!0,!1,this.score)}}]),e}(Phaser.State);i["default"]=l},{}],6:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),a=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"preload",value:function(){this.add.text(0,0,"",{font:"1px Fredoka One",fill:"#f6e787"}),this.load.image("logo","./images/donuts_logo.png"),this.load.image("btn-play","./images/btn-play.png"),this.load.image("btn-sfx","./images/btn-sfx.png"),this.load.image("gem-01","./images/game/gem-01.png"),this.load.image("gem-02","./images/game/gem-02.png"),this.load.image("gem-03","./images/game/gem-03.png"),this.load.image("gem-04","./images/game/gem-04.png"),this.load.image("gem-05","./images/game/gem-05.png"),this.load.image("gem-06","./images/game/gem-06.png"),this.load.image("gem-shadow","./images/game/shadow.png"),this.load.image("bg-score","./images/bg-score.png"),this.load.image("timeup","./images/text-timeup.png"),this.load.audio("bg-music","./audio/background.mp3"),this.load.audio("select-1","./audio/select-1.mp3"),this.load.audio("score-sound","./audio/kill.mp3")}},{key:"create",value:function(){this.state.start("Menu")}}]),e}(Phaser.State);i["default"]=a},{}]},{},[1]);